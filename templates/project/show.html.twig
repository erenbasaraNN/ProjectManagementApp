{% extends 'base.html.twig' %}

{% block title %}Project: {{ project.name }}{% endblock %}

{% block body %}
    <div class="project-header">
        <h1>{{ project.name }}</h1>
        <p>{{ project.description }}</p>
    </div>
    <div class="project-page container">
        <!-- Project Header -->


        <!-- Grouped Issues Table -->
        <div class="issue-groups">
            {% for tag in tags %}
                <div class="group">
                    <!-- Tag Group Header with color -->
                    <div class="group-header" style="border-left: 20px solid {{ tag.color }}; border-radius:5px;">
                        <h3>{{ tag.name }}</h3>
                    </div>
                    <table class="issue-table">
                        <thead>
                        <tr>
                            <th>Görev</th>
                            <th>Kişi</th>
                            <th>Durum</th>
                            <th>Tarih</th>
                            <th>Priority</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% if tag.issues|length > 0 %}
                            {% for issue in tag.issues %}
                                <tr>
                                    <td>
                                        <span class="issue-name" data-id="{{ issue.id }}" contenteditable="true">{{ issue.name }}</span>
                                    </td>
                                    <td>
                                        <input class="tagify-input" name="assignees" data-id="{{ issue.id }}"
                                               value="{% for user in issue.assignees %}{{ user.name }}{% if not loop.last %}, {% endif %}{% endfor %}"
                                               placeholder="Kişi seç...">
                                    </td>
                                    <td>
                                        <div class="dropdown-container">
                                            <select class="status-dropdown" data-id="{{ issue.id }}">
                                                <option value="Completed" {% if issue.status == 'Completed' %}selected{% endif %} class="status-completed">Tamamlandı</option>
                                                <option value="In Progress" {% if issue.status == 'In Progress' %}selected{% endif %} class="status-in-progress">Aktif Durumda</option>
                                                <option value="Cancelled" {% if issue.status == 'Cancelled' %}selected{% endif %} class="status-canceled">İptal</option>
                                                <option value="To DO" {% if issue.status == 'To DO' %}selected{% endif %} class="status-not-started">Başlanacak</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <input type="text" class="datepicker" data-id="{{ issue.id }}" value="{{ issue.endDate ? issue.endDate|date('d M') : 'No Deadline' }}">
                                    </td>
                                    <td>
                                        <select class="priority-select" data-id="{{ issue.id }}">
                                            <option value="Düşük" {% if issue.priority == 'Düşük' %}selected{% endif %} style="background-color: lightblue;">Düşük</option>
                                            <option value="Orta" {% if issue.priority == 'Orta' %}selected{% endif %} style="background-color: blue;">Orta</option>
                                            <option value="Yüksek" {% if issue.priority == 'Yüksek' %}selected{% endif %} style="background-color: darkblue;">Yüksek</option>
                                        </select>
                                    </td>
                                </tr>
                            {% endfor %}
                            <tr class="add-task-row">
                                <td colspan="6">
                                    <a href="#" class="add-task-link">
                                        <i class="fas fa-plus"></i> + öğe ekle
                                    </a>
                                </td>
                            </tr>
                        {% else %}
                            <tr>
                                <td colspan="6">No issues available under this group.</td>
                            </tr>
                        {% endif %}
                        </tbody>
                    </table>

                </div>
            {% endfor %}
        </div>
    </div>


{% endblock %}
